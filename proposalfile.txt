Some changes are proposed from Aaqib
